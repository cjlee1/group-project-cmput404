<!-- templates/friendrequest/friendrequest.html -->
{% extends 'base.html' %}

{% block title %}Send friend request{% endblock %}

{% block content %}
{% if user.is_authenticated %}
  {% load static %}
  <link rel="stylesheet" type="text/css" href="{% static 'upload/upload.css' %}">

  <!--This is the friends page
      In the future this will probably be on the users profile page
      But again, this is like the first iteration of the thingy, proof of concept
      The accept and ignore buttons should use AJAX to send/ignore the request
      Then refresh the dom/friend list
      -->
  <h1 class="section-header">Friend Requests</h1>
  {% for r in requests %}
    <div>
      {{ r }} 
      <button type="button" class="addfriend btn btn-secondary">Accept</button>
      <button type="button" class="removefriend btn btn-danger">Ignore</button>
      <hr class="separator">
      <script type="text/javascript">
        $(document).ready(function() {
          console.log("does this work?");
          const Url = "http://127.0.0.1:8000/friendrequest";
          var author = "{{request.user}}";
          var requestor = "{{r}}";
          $(".addfriend").click(function() {
            console.log("add this friend");
            var data = {
              "author": author,
              "friend": requestor,
            };
            var jsonData = JSON.stringify(data);
            $.ajax({
              url: Url,
              type: "POST",
              data: jsonData,
              contentType: "application/json",
              success: function(result){
                console.log("time to remove this row");
              }
            })
          })
          $(".removefriend").click(function() {
            console.log("remove this friend");
          });
        });
      </script>
    </div>    
  {% endfor %}
  
  </br>
  <h1 class="section-header">Friends</h1>
  {% for friend in friends %}
    <!-- this should be a hyperlink to their profile -->
    <div>
      {{ friend }}
    </div>
  {% endfor %}
{% else %}
  {% load static %}
  <link rel="stylesheet" type="text/css" href="{% static 'login/login.css' %}">

  <p>You are not logged in</p>
  <a href="{% url 'login' %}">login</a>
{% endif %}
{% endblock %}

